# Deploy workflow -- disabled until EAS + store accounts are set up.
# Uncomment when ready for CI deploys.
#
# Prerequisites:
#   1. Run `eas init` from apps/mobile (links to Expo account)
#   2. Add GitHub secrets:
#      - EXPO_TOKEN: https://expo.dev/settings/access-tokens
#      - CONVEX_DEPLOY_KEY: Convex dashboard > Settings > Deploy key
#   3. Apple Developer ($99/yr) for iOS builds
#   4. Google Play Console ($25) for Android distribution (optional -- can sideload APK)
#
# name: deploy
#
# on:
#   push:
#     branches: [main, master]
#
# concurrency:
#   group: deploy
#   cancel-in-progress: false
#
# jobs:
#   convex:
#     name: convex deploy
#     runs-on: ubuntu-latest
#     permissions:
#       contents: read
#       id-token: write
#     steps:
#       - uses: actions/checkout@v4
#
#       - uses: DeterminateSystems/determinate-nix-action@v3
#
#       - uses: DeterminateSystems/flakehub-cache-action@main
#
#       - name: install dependencies
#         run: nix develop --command bun install
#
#       - name: deploy convex
#         run: nix develop --command bun run --filter='@reread/convex' deploy
#         env:
#           CONVEX_DEPLOY_KEY: ${{ secrets.CONVEX_DEPLOY_KEY }}
#
#   ios:
#     name: build ios
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@v4
#
#       - uses: expo/expo-github-action@v8
#         with:
#           eas-version: latest
#           token: ${{ secrets.EXPO_TOKEN }}
#
#       - name: install dependencies
#         run: bun install
#
#       - name: build ios
#         run: eas build --platform ios --profile production --non-interactive
#         working-directory: apps/mobile
#
#   android:
#     name: build android
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@v4
#
#       - uses: expo/expo-github-action@v8
#         with:
#           eas-version: latest
#           token: ${{ secrets.EXPO_TOKEN }}
#
#       - name: install dependencies
#         run: bun install
#
#       - name: build android
#         run: eas build --platform android --profile production --non-interactive
#         working-directory: apps/mobile
